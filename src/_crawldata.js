// ************************************************
var lastGen = {};

lastGen.djanga = {
  "chart": {
    "container": "#pedigree-tree",
    "levelSeparation": 30,
    "rootOrientation": "WEST",
    "nodeAlign": "BOTTOM",
    "connectors": {
      "type": "step",
      "style": {
        "stroke-width": 2,
        "stroke": "#bbb"
      }
    },
    "node": {
      "HTMLclass": "dog-pedigree"
    }
  },
  "nodeStructure": {
    "text": {
      "name": "Django Od Moslavine"
    },
    "connectors": {
      
    },
    "stackChildren": true,
    "children": [
      {
        "text": {
          "name": "Chapman vom Holzmicheltal"
        },
        "connectors": {
          
        },
        "stackChildren": true,
        "children": [
          {
            "text": {
              "name": "Alf vom Nordhang der Eifel"
            },
            "connectors": {
              
            },
            "stackChildren": true,
            "children": [
              {
                "text": {
                  "name": "Daneskjold Hasse"
                },
                "connectors": {
                  
                },
                "stackChildren": true,
                "children": [
                  {
                    "text": {
                      "name": "Arek von der Wautz"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/40/Arek-von-der-Wautz"
                    }
                  },
                  {
                    "text": {
                      "name": "Snake NHSB 1815586"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/405/Snake-NHSB-1815586"
                    }
                  }
                ],
                "link": {
                  "href": "https://www.working-dog.com/dogs-details/165/Daneskjold-Hasse"
                }
              },
              {
                "text": {
                  "name": "Engie Airport Hannover"
                },
                "connectors": {
                  
                },
                "stackChildren": true,
                "children": [
                  {
                    "text": {
                      "name": "Onix von Löwenfels"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/367/Onix-von-L%C3%B6wenfels"
                    }
                  },
                  {
                    "text": {
                      "name": "Virginia von Löwenfels"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/427/Virginia-von-L%C3%B6wenfels"
                    }
                  }
                ],
                "link": {
                  "href": "https://www.working-dog.com/dogs-details/558/Engie-Airport-Hannover"
                }
              }
            ],
            "link": {
              "href": "https://www.working-dog.com/dogs-details/10/Alf-vom-Nordhang-der-Eifel"
            }
          },
          {
            "text": {
              "name": "Akida von Skandinavika"
            },
            "connectors": {
              
            },
            "stackChildren": true,
            "children": [
              {
                "text": {
                  "name": "Igor Perle de Tourbière"
                },
                "connectors": {
                  
                },
                "stackChildren": true,
                "children": [
                  {
                    "text": {
                      "name": "Larco Perle de Tourbière"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/784/Larco-Perle-de-Tourbi%C3%A8re"
                    }
                  },
                  {
                    "text": {
                      "name": "Jill Perle de Tourbière"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/785/Jill-Perle-de-Tourbi%C3%A8re"
                    }
                  }
                ],
                "link": {
                  "href": "https://www.working-dog.com/dogs-details/270/Igor-Perle-de-Tourbi%C3%A8re"
                }
              },
              {
                "text": {
                  "name": "Bonny de mare baltico vehemente"
                },
                "connectors": {
                  
                },
                "stackChildren": true,
                "children": [
                  {
                    "text": {
                      "name": "Brando Airport Hannover"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/111/Brando-Airport-Hannover"
                    }
                  },
                  {
                    "text": {
                      "name": "Gadea von Löwenfels"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/559/Gadea-von-L%C3%B6wenfels"
                    }
                  }
                ],
                "link": {
                  "href": "https://www.working-dog.com/dogs-details/4941/Bonny-de-mare-baltico-vehemente"
                }
              }
            ],
            "link": {
              "href": "https://www.working-dog.com/dogs-details/10649/Akida-von-Skandinavika"
            }
          }
        ],
        "link": {
          "href": "https://www.working-dog.com/dogs-details/421170/Chapman-vom-Holzmicheltal"
        }
      },
      {
        "text": {
          "name": "Lili od Slunja"
        },
        "connectors": {
          
        },
        "stackChildren": true,
        "children": [
          {
            "text": {
              "name": "Conan van Karlosha"
            },
            "connectors": {
              
            },
            "stackChildren": true,
            "children": [
              {
                "text": {
                  "name": "Devil van Joefarm"
                },
                "connectors": {
                  
                },
                "stackChildren": true,
                "children": [
                  {
                    "text": {
                      "name": "Yagus van de Duvetorre"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/1424/Yagus-van-de-Duvetorre"
                    }
                  },
                  {
                    "text": {
                      "name": "Arva van Joefarm"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/11233/Arva-van-Joefarm"
                    }
                  }
                ],
                "link": {
                  "href": "https://www.working-dog.com/dogs-details/72057/Devil-van-Joefarm"
                }
              },
              {
                "text": {
                  "name": "Dinia van Joefarm"
                },
                "connectors": {
                  
                },
                "stackChildren": true,
                "children": [
                  {
                    "text": {
                      "name": "Roe van Joefarm"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/783/Roe-van-Joefarm"
                    }
                  },
                  {
                    "text": {
                      "name": "Shara van Joefarm"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/2467/Shara-van-Joefarm"
                    }
                  }
                ],
                "link": {
                  "href": "https://www.working-dog.com/dogs-details/72058/Dinia-van-Joefarm"
                }
              }
            ],
            "link": {
              "href": "https://www.working-dog.com/dogs-details/86104/Conan-van-Karlosha"
            }
          },
          {
            "text": {
              "name": "Dina od Slunja"
            },
            "connectors": {
              
            },
            "stackChildren": true,
            "children": [
              {
                "text": {
                  "name": "Chip vom Turda"
                },
                "connectors": {
                  
                },
                "stackChildren": true,
                "children": [
                  {
                    "text": {
                      "name": "Blitz von der Ihleburg"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/2142/Blitz-von-der-Ihleburg"
                    }
                  },
                  {
                    "text": {
                      "name": "Ailina vom Haus Seli"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/2635/Ailina-vom-Haus-Seli"
                    }
                  }
                ],
                "link": {
                  "href": "https://www.working-dog.com/dogs-details/234781/Chip-vom-Turda"
                }
              },
              {
                "text": {
                  "name": "Astra  HR 10639"
                },
                "connectors": {
                  
                },
                "stackChildren": true,
                "children": [
                  {
                    "text": {
                      "name": "Apollo von den Obirhöhlen"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/2046/Apollo-von-den-Obirh%C3%B6hlen"
                    }
                  },
                  {
                    "text": {
                      "name": "Oti  HR 10510 (Mato)"
                    },
                    "connectors": {
                      
                    },
                    "stackChildren": true,
                    "children": [
                      
                    ],
                    "link": {
                      "href": "https://www.working-dog.com/dogs-details/60283/Oti--HR-10510-Mato"
                    }
                  }
                ],
                "link": {
                  "href": "https://www.working-dog.com/dogs-details/926547/Astra--HR-10639"
                }
              }
            ],
            "link": {
              "href": "https://www.working-dog.com/dogs-details/1020407/Dina-od-Slunja"
            }
          }
        ],
        "link": {
          "href": "https://www.working-dog.com/dogs-details/1020408/Lili-od-Slunja"
        }
      }
    ],
    "link": {
      "href": "https://www.working-dog.com/dogs-details/3144786/Django-Od-Moslavine"
    }
  }
};

// lastGen
// ************************************************

var nodeStructure = [];
var dogNames = [];

$(".pedigree-wrapper ul li a").each(function() {
	var dogName = $(this).text();
	var dogLink = $(this).attr("href");
	dogNames.push({
		name: dogName,
		link: dogLink
	});
});

let lastGenNames = null;

try{
	// populate lgd with gen 4 before running this script
	lastGenNames = lgd;
} catch(err){

}

function getLastGen() {
	if (!lastGenNames || !lastGenNames.length) {
		return null;
	}

	return lastGenNames.splice(0, 2);
}

function removeLastGen() {
	data.nodeStructure
}

function createDog(data, childrenData) {
	let children = [];

	if (childrenData) {
		children = [createDog(childrenData[0]), createDog(childrenData[1])];
	}

	let structure = {
		text: { name: data.name },
		connectors: {},
		stackChildren: true,
		children: children
	};

	if (data.link) {
		structure.link = {
			href: data.link
		}
	}

	return structure;
}


var d0 = createDog(dogNames[0]);
d0.children = [createDog(dogNames[1]), createDog(dogNames[2])];

d0.children[0].children = [createDog(dogNames[3], getLastGen()), createDog(dogNames[4], getLastGen())];
d0.children[1].children = [createDog(dogNames[5], getLastGen()), createDog(dogNames[6], getLastGen())];

var d1 = createDog(dogNames[7]);
d1.children = [createDog(dogNames[8]), createDog(dogNames[9])];

d1.children[0].children = [createDog(dogNames[10], getLastGen()), createDog(dogNames[11], getLastGen())];
d1.children[1].children = [createDog(dogNames[12], getLastGen()), createDog(dogNames[13], getLastGen())];

var original = createDog({name: $(".showTitle").text(), link: window.location.href});
original.children = [d0, d1];

console.log(original);

var data = {
	chart: {
		container: "#pedigree-tree",
		levelSeparation: 30,

		rootOrientation: "WEST",

		nodeAlign: "BOTTOM",

		connectors: {
			type: "step",
			style: {
				"stroke-width": 2,
				stroke: "#bbb"
			}
		},
		node: {
			HTMLclass: "dog-pedigree"
		}
	},
	nodeStructure: original
};

copy(JSON.stringify(data));
console.log(data);
